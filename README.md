# Облачное хранилище

Дипломная работа: создание REST-интерфейса для загрузки файлов и вывода списка уже загруженных файлов пользователя.

## Функционал приложения

- **Авторизация** — доступ к функционалу по логину и паролю.
- **Вывод списка файлов** — отображение всех файлов пользователя.
- **Добавление файла** — загрузка нового файла на сервер.
- **Удаление файла** — удаление загруженного файла.
- **Скачивание файла** — возможность скачать ранее загруженный файл.
- **Изменение имени файла** — переименование уже загруженного файла.

## Существующие пользователи

Для авторизации можно использовать следующие учетные записи:

- `user1`, `password1`
- `user2`, `password2`
- `user3`, `password3`

> **Примечание**: пароли не зашифрованы для упрощения работы с базой данных через Liquibase (пароли можно посмотреть непосредственно в таблице `users`).

## Технологии

- **Java 17**
- **Maven**
- **Spring Boot**
- **Spring Security**
- **JWT**
- **Spring Data JPA**
- **Hibernate**
- **PostgreSQL**
- **Liquibase** (для создания и наполнения таблиц)
- **JUnit 5**
- **Testcontainers**
- **Docker**

## Особенности работы с токенами

- При выходе пользователя из системы (logout) его JWT токен добавляется в список заблокированных (`token_blacklist`).

## Работа с файлами

- Файлы сохраняются в **storage** в контейнере.
- В таблице **files** хранится путь до файла.
- Для каждого пользователя создается отдельная папка, куда сохраняются его файлы.
- Пользователи могут сохранять файлы с одинаковыми именами, но каждый пользователь не может загрузить файл с таким же именем, как у него уже есть.
- При сохранении файла выводится информация о его местоположении в хранилище.
- Операции с файлами (удаление, переименование) синхронизированы с таблицей **files** и с физическими файлами в хранилище.

## Правила именования файлов

- Запрещены следующие символы в имени файла:
    - Пробелы (например, пробел между символами)
    - Специальные символы: `!`, `@`, `#`, `$`, `%`, `&`, `*`, `+`, `=`, `^`, `{`, `}`, `[`, `]`, `|`, `\`, `;`, `:`, `"`, `'`, `<`, `>`, `?`, `/`, `\`, и другие символы, которые не перечислены в регулярном выражении.

> Имя файла берется из URL, независимо от оригинального имени загружаемого файла.

## Проверка загружаемых файлов

Запрещенные расширения файлов:
- `exe`, `bat`, `sh`, `cmd`, `scr`, `ps1`, `jar`, `msi`, `vbs` и другие потенциально вредоносные файлы.
- Файлы без расширений также не принимаются.

Максимальный размер файла: **5 МБ**.

## Как запустить

1. **Склонировать проект**

   ```bash
   git clone https://github.com/NataliaKubiak/diploma-cloudservice.git
   cd diploma-cloudservice

2. **Собрать JAR файл через Maven**

   ```bash
   mvn clean package

3. **Собрать Docker образ и запустить приложение**

   ```bash
   docker-compose up --build

4. **Доступ к приложению**

   ```bash
   http://localhost:8080/login